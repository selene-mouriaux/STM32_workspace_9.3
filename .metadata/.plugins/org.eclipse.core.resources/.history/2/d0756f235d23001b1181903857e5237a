/*
 * debug.c
 *
 *  Created on: Oct 14, 2020
 *      Author: silvanas
 */

#include "debug.h"
#include <stdarg.h>
#include <stdio.h>
#include <string.h>

static int debugLevel = 0;

void debug_setlevel(int inNewLevel) {
	debugLevel = inNewLevel;
}

int debug_pr_fn(int inLevel, const char *format, ...) {
	if (inLevel <= debugLevel) {
		va_list (ap);
		va_start(ap, format);
		int out = vfprintf(stdout, format, ap);
		fflush(stdout);
		va_end(ap);
		return out;
	}
	return 0;
}

char sendDebugMessage(int message_type, char* debug_message) {
	int size = strlen(debug_message);
	int i = 0;
	int to_upper = 'a' - 'A';
	char tmp_message[size];
	char message[size];
	memcpy(message, debug_message, size);
	if (message_type ==  1) {
		for(i=0 ; i<size ; i++) {
			int castvar_i = message[i];
			message[i] = castvar_i - to_upper;
		}
	}
	if (message_type == 2) {
		for(i=0 ; i<size ; i++) {
			tmp_message[i] = message[size-i];
		}
		return strcat(strcat("d", tmp_message),"\n");
	}
	return strcat(strcat("d", message),"\n");
}
